---
layout: default
---

<div class="container my-5">

    {% include breadcrumb-github-projects.html
    collection_url = "/blog/"
    collection_name = "Blog"
    item_icon = "fas fa-pencil-alt"
    %}

    {% comment %}
    ===================================================================
    MODIFIED: Added 'g-4' for spacing between the new columns
    ===================================================================
    {% endcomment %}
    <div class="row g-4">

        {% comment %}
        ===================================================================
        NEW: Sidebar Column (Table of Contents & Related Posts)
        ===================================================================
        {% endcomment %}
        <div class="col-lg-4 order-lg-2">
            <div class="position-sticky sticky-sidebar" style="top: 2rem;">

                {% if page.toc == true %}
                <div class="card shadow-sm border-0 mb-4" id="toc-placeholder">
                    <div class="d-flex">
                        <div class="flex-shrink-0 text-primary p-3" style="min-width: 80px; text-align: center;">
                            <i class="fas fa-list-ol fa-3x"></i>
                        </div>
                        <div class="flex-grow-1 card-body">
                            <h5 class="card-title">On this page</h5>
                            <small class="text-muted">Table of Contents</small>
                            <div class="toc-content mt-3" id="toc-container">
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                {% comment %}
                ===================================================================
                NEW: Related Posts Card (Integrated Logic)
                - Logic is identical (scoring, sorting by last tag).
                - Output is adapted to a vertical list inside a sidebar card
                to match the "On this page" card's design.
                ===================================================================
                {% endcomment %}

                {% assign max_related = 3 %}
                {% assign current_tags = page.tags %}

                {% if current_tags.size > 0 %}

                {% assign related_posts_with_scores = '' | split: ',' %}

                {% for post in site.posts %}
                {% unless post.url == page.url %}

                {% assign post_score = 0 %}
                {% assign post_tags = post.tags %}

                {% for i in (0..current_tags.size) reversed %}
                {% assign current_tag = current_tags[i] %}
                {% if current_tag %}
                {% assign tag_weight = i | plus: 1 %}
                {% if post_tags contains current_tag %}
                {% assign post_score = post_score | plus: tag_weight %}
                {% endif %}
                {% endif %}
                {% endfor %}

                {% if post_score > 0 %}
                {% assign post_data = post_score | append: '|' | append: post.url %}
                {% assign related_posts_with_scores = related_posts_with_scores | push: post_data %}
                {% endif %}

                {% endunless %}
                {% endfor %}

                {% assign sorted_related_posts = related_posts_with_scores | sort | reverse %}

                {% if sorted_related_posts.size > 0 %}
                <div class="card shadow-sm border-0 mb-4">
                    <div class="d-flex">
                        <div class="flex-shrink-0 text-primary p-3" style="min-width: 80px; text-align: center;">
                            <i class="fas fa-book-open-reader fa-3x"></i>
                        </div>
                        <div class="flex-grow-1 card-body">
                            <h5 class="card-title">Related Readings</h5>
                            <small class="text-muted">Based on shared topics</small>
                            <div class="mt-3">

                                {% for post_data in sorted_related_posts limit: max_related %}

                                {% assign post_url = post_data | split: '|' | last %}
                                {% assign post = site.posts | where: "url", post_url | first %}

                                {% assign shared_tags = '' | split: ',' %}
                                {% for tag in post.tags %}{% if current_tags contains tag %}{% assign shared_tags = shared_tags | push: tag %}{% endif %}{% endfor %}

                                <div class="{% unless forloop.last %}mb-3{% endunless %}">
                                    <h6 class="mb-0">
                                        <a href="{{ post.url | relative_url }}" class="text-decoration-none">{{ post.title }}</a>
                                    </h6>
                                    <small class="text-muted">{{ post.date | date: "%B %d, %Y" }}</small>

                                    {% if shared_tags.size > 0 %}
                                    <div class="mt-1">
                                        {% for tag in shared_tags %}
                                        <span class="badge rounded-pill text-bg-light me-1 fw-normal">{{ tag | capitalize }}</span>
                                        {% endfor %}
                                    </div>
                                    {% endif %}
                                </div>

                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endif %}
            </div>
        </div>

        {% comment %}
        ===================================================================
        MODIFIED: Main Content Column
        ===================================================================
        {% endcomment %}
        <div class="col-lg-8 order-lg-1">

            <header class="p-4 mb-4 bg-light rounded-3 shadow-sm">
                {% comment %} --- REDUCED HEADING SIZE: Using display-6 for a balanced, less overwhelming title --- {% endcomment %}
                <h1 class="display-6 fw-bold mb-3">{{ page.title }}</h1>

                {% assign has_meta = false %}
                {% if page.date or page.author %}{% assign has_meta = true %}{% endif %}

                {% if has_meta %}
                <p class="small text-muted mb-3">
                    {% if page.date %}
                    <i class="far fa-calendar-alt fa-fw me-1"></i> Posted on {{ page.date | date: "%-d %b %Y" }}
                    {% endif %}

                    {% comment %} Robust Author Link Lookup {% endcomment %}
                    {% if page.author %}
                    | by
                    {% assign author_found = false %}
                    {% for member in site.categories.team %}
                    {% if member.name == page.author %}
                    <a href="{{ member.url | relative_url }}" class="text-decoration-none text-info">{{ page.author }}</a>
                    {% assign author_found = true %}
                    {% break %}
                    {% endif %}
                    {% endfor %}
                    {% unless author_found %}
                    <span class="text-muted">{{ page.author }}</span>
                    {% endunless %}
                    {% endif %}
                </p>
                {% endif %}

                {% if page.tags %}
                <div class="d-flex flex-wrap" style="gap: 0.5rem;">
                    {% for tag in page.tags %}
                    <a href="/blog/tags/#{{ tag | slugify }}" class="badge bg-secondary text-white text-decoration-none border">#{{ tag }}</a>
                    {% endfor %}
                </div>
                {% endif %}
            </header>

            {% if page.image %}
            <div class="my-4 text-center">
                <img src="{{ page.image | relative_url }}" class="img-fluid rounded shadow-lg" alt="{{ page.title }}">
            </div>
            {% endif %}

            <article class="post-content mt-5" id="post-content-container">
                {{ content }}
            </article>
        </div>

    </div>
</div>