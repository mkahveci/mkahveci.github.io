---
layout: post
title: LaTeX Tweaks
author: Murat Kahveci
image: /images/blog/latex.jpg
tags: 
    - Typesetting
    - Manuals
published: true
---

## Introduction

[LaTeX](https://www.latex-project.org) has long been my main typesetting environment. This post has some handy dandy codes that I daily use. 

## Exam Class

### 1. My Template 

```latex
\documentclass[
% answers 
,addpoints]{exam}

\newcommand{\class}{CHEM 173}
\def\day{1}  % exam / quiz / worksheet #
\def\topic{} % title

\pagestyle{head} % head (for printing); empty (for embedding)

\input{_preamble}
\begin{document}
\input{_instructions} 

\begin{questions}	
	
\question[10] 	
		
\end{questions}

\end{document}
```

`\input{_preamble}` file codes:

```latex
\runningheader{\class}{Lab \day\ Worksheet}{Page \thepage\ of \numpages}
\runningheadrule
%\framedsolutions
\unframedsolutions

\usepackage[utf8]{inputenc}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amssymb}
\usepackage{multicol} % Multi column environment 
\usepackage{siunitx} % Format scientific units
\usepackage{chemformula} % Format Chemical Formulae
\usepackage{adjustbox}
\usepackage{tabularx}

%% MoveQuestionNextPage
\newcommand{\MoveQuestionNextPage}{
  \ifprintanswers \else 
     \clearpage
  \fi
}%

%% Color settings
\definecolor{blue-violet}{rgb}{0.54, 0.17, 0.89}
\SolutionEmphasis{\color{blue-violet}}
\CorrectChoiceEmphasis{\color{blue-violet}\bfseries}
```
`\input{_instructions}` file codes:

```latex
\ifprintanswers 
\firstpageheader{\class}{Lab \day\ Worksheet}{\examdate}
\firstpageheadrule
\begin{center}
	{\color{blue-violet}{\large{\textbf{KEY}}}}
\end{center}

\else

\noindent
\begin{tabular*}{\textwidth}{@{}l @{\extracolsep{\fill}} r @{\extracolsep{5pt}} l@{}}
\textbf{\class\ - Worksheet} & \textbf{Name:} & \fillin \fillin \\
\textbf{Lab \day. \topic} &\textbf{Date:} & \fillin \fillin \\
\textbf{Section: \fillin} &\textbf{TA:} & \fillin \fillin \\
\end{tabular*}\\
\rule[1ex]{\textwidth}{2pt}

%This worksheet contains \numpages\ pages and \numquestions\ questions. Please add all the names of  "contributing group members." 
%
%\begin{center}
%
%Grade Table (for teacher use only)\\
%\addpoints
%\resizebox{\textwidth}{!}{
%\gradetable[h][questions]
%}
%\end{center}
%
%\noindent
%\rule[1ex]{\textwidth}{2pt} 
\fi
```

### 2. Question with Solution Box 

```latex
\question

\begin{solutionorbox}[\fill] 
\end{solutionorbox}
```

### 3. Multiple Choice Items

One line:

```latex
\begin{oneparchoices}
    \choice
\end{oneparchoices}
```

Multiple lines:

```latex
\begin{choices}
    \choice
\end{choices}
```

### 4. Multipart Question

```latex
\question

\begin{parts}
    \part
    \begin{solutionorbox}[\fill] 
    \end{solutionorbox}
    
    \part
    \begin{solutionorbox}[\fill] 
    \end{solutionorbox}    
\end{parts}
```
### 5. Two-Column Question 

```latex
\begin{minipage}{0.6\textwidth}
    \question 

\begin{oneparchoices}
	\choice	  
	\CorrectChoice	  
\end{oneparchoices}	

    \begin{solution} 
    \end{solution}
    
\end{minipage}
\begin{minipage}{0.4\textwidth}
    \fbox{\includegraphics[width=.94\textwidth]{}}
\end{minipage}
```

### 6. Add Bonus Questions/Parts

```latex
\bonusquestion[5]
```

```latex
\bonuspart[5]
```

### 7. Move Question to Next Page 

Move question/part to the next page to satisfy space requirements. `\MoveQuestionNextPage` is omitted while `Exam Key` is generated because key does not need any answer space for data entry.

```latex
\MoveQuestionNextPage
```
Command in preamble:

```latex
\newcommand{\MoveQuestionNextPage}{
    \ifprintanswers \else 
        \clearpage
    \fi
}
```

## Embedding a PDF File within

```latex
\portitem
  {} % title
  {./path-to/file.pdf} % file name
  {n} % n = page number + 1
```

To achieve a clean layout, remove headers and footers in `file.pdf`. Typically, `outer PDF` will carry out its headers and footers. This approach also provides a seamless integration.

Command in preamble:

```latex
\newcommand{\portitem}[3]{
	\phantomsection  \addcontentsline{toc}{section}{#1} % toc entry
	\rhead{\textsc{#1}}
	\setcounter{pg}{1}
	\whiledo{\value{pg}<#3}{ % page number +1
		\includepdf[pages=\thepg,scale=1,pagecommand={\pagestyle{fancy}}]{#2} % file name
		\addtocounter{pg}{1} 
	}
}
```

Package dependencies in preamble:

```latex
\usepackage{pdfpages}
\usepackage{ifthen}
\newcounter{pg}
```

## Stamping Unique IDs

Often I print out documents with multiple copies. When it comes to exams, usually I scan the documents and do my grading electronically. Having unique IDs on every copy printed provides better file handling in this process.

{% highlight latex %}
{% raw %}
\documentclass[letterpaper,10pt]{article}

\usepackage{pdfpages}
\usepackage{fancyhdr}
\usepackage{color}
\usepackage{multido}

% What is the starting number?
\def\startnumber{1}

% How many exams do we need?
\def\numberofexams{90}

% Which is the input PDF file?
\def\examfile{CHEM111-lab-manuals-2022-08-25}

% This is to control the placement of the number.  
\textwidth  440pt
\textheight 590pt

% We use headers to output the serial number
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt} % No header line
\renewcommand{\footrulewidth}{0pt} % No footer line
\cfoot{}

% Actual command to include the serial number
\rfoot{\Huge\textcolor{gray!25}{\textsf{%
			% Some number padding - for up to 999 exams
			\ifnum\numberexam<100 0\fi%
			\ifnum\numberexam<10 0\fi%
			\numberexam}
}}

% And here comes the single loop across all documents
% pagecommand by itself adds nothing, 
% but causes our new headers and footers to be printed
\begin{document}
	\multido{\numberexam=\startnumber+1}{\numberofexams}{%
		\includepdf[pages=-,pagecommand=\strut]{\examfile}
	}
\end{document}
{% endraw %}
{% endhighlight %}