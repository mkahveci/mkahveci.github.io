---
layout: post
title: LaTeX Tweaks
author: Murat Kahveci
image: /images/blog/latex.jpg
tags: 
    - Typesetting
    - Manuals
published: true
---

## Introduction

[LaTeX](https://www.latex-project.org) has long been my main typesetting environment. This post has some handy dandy codes that I daily use. 

## Exam Class

### 1. My Exam Template 

```latex
\documentclass[
% answers 
,addpoints]{exam}

\newcommand{\class}{CHEM 173}
\def\day{1}  % exam / quiz / worksheet #
\def\topic{} % title

\pagestyle{head} % head (for printing); empty (for embedding)

\input{_preamble}
\begin{document}
\input{_instructions} 

\begin{questions}	
	
\question[10] 	
		
\end{questions}

\end{document}
```

### 2. `\input{_preamble}` File Contents

```latex
\runningheader{\class}{Lab \day\ Worksheet}{Page \thepage\ of \numpages}
\runningheadrule
%\framedsolutions
\unframedsolutions

\usepackage[utf8]{inputenc}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amssymb}
\usepackage{multicol} % Multi column environment 
\usepackage{siunitx} % Format scientific units
\usepackage{chemformula} % Format Chemical Formulae
\usepackage{adjustbox}
\usepackage{tabularx}

%% MoveQuestionNextPage
\newcommand{\MoveQuestionNextPage}{
  \ifprintanswers \else 
     \clearpage
  \fi
}%

%% Color settings
\definecolor{blue-violet}{rgb}{0.54, 0.17, 0.89}
\SolutionEmphasis{\color{blue-violet}}
\CorrectChoiceEmphasis{\color{blue-violet}\bfseries}
```
### 3. `\input{_instructions}` File Content

```latex
\ifprintanswers 
\firstpageheader{\class}{Lab \day\ Worksheet}{\examdate}
\firstpageheadrule
\begin{center}
	{\color{blue-violet}{\large{\textbf{KEY}}}}
\end{center}

\else

\noindent
\begin{tabular*}{\textwidth}{@{}l @{\extracolsep{\fill}} r @{\extracolsep{5pt}} l@{}}
\textbf{\class\ - Worksheet} & \textbf{Name:} & \fillin \fillin \\
\textbf{Lab \day. \topic} &\textbf{Date:} & \fillin \fillin \\
\textbf{Section: \fillin} &\textbf{TA:} & \fillin \fillin \\
\end{tabular*}\\
\rule[1ex]{\textwidth}{2pt}

%This worksheet contains \numpages\ pages and \numquestions\ questions. Please add all the names of  "contributing group members." 
%
%\begin{center}
%
%Grade Table (for teacher use only)\\
%\addpoints
%\resizebox{\textwidth}{!}{
%\gradetable[h][questions]
%}
%\end{center}
%
%\noindent
%\rule[1ex]{\textwidth}{2pt} 
\fi
```

### 4. Question with Solution Box 

```latex
\question

\begin{solutionorbox}[\fill] 
\end{solutionorbox}
```

### 5. Multiple Choice Items

One line:

```latex
\begin{oneparchoices}
    \choice
\end{oneparchoices}
```

Multiple lines:

```latex
\begin{choices}
    \choice
\end{choices}
```

### 6. Multipart Question

```latex
\question

\begin{parts}
    \part
    \begin{solutionorbox}[\fill] 
    \end{solutionorbox}
    
    \part
    \begin{solutionorbox}[\fill] 
    \end{solutionorbox}    
\end{parts}
```
### 7. Two-Column Question 

```latex
\begin{minipage}{0.6\textwidth}
    \question 

\begin{oneparchoices}
	\choice	  
	\CorrectChoice	  
\end{oneparchoices}	

    \begin{solution} 
    \end{solution}
    
\end{minipage}
\begin{minipage}{0.4\textwidth}
    \fbox{\includegraphics[width=.94\textwidth]{}}
\end{minipage}
```

### 8. Add Bonus Questions/Parts

```latex
\bonusquestion[5]
```

```latex
\bonuspart[5]
```

### 9. Move Question to Next Page 

Move question/part to the next page to satisfy space requirements. `\MoveQuestionNextPage` is omitted while `Exam Key` is generated because key does not need any answer space for data entry.

```latex
\MoveQuestionNextPage
```
Command:

```latex
\newcommand{\MoveQuestionNextPage}{
    \ifprintanswers \else 
        \clearpage
    \fi
}
```

### 10. Embedding a PDF File Within

```latex
\portitem
  {} % title
  {./path-to/file.pdf} % file name
  {n} % n = page number + 1
```

Clear headers and footers in `file.pdf`.

Command in preamble:

```latex
\newcommand{\portitem}[3]{
	\phantomsection  \addcontentsline{toc}{section}{#1} % toc entry
	\rhead{\textsc{#1}}
	\setcounter{pg}{1}
	\whiledo{\value{pg}<#3}{ % page number +1
		\includepdf[pages=\thepg,scale=1,pagecommand={\pagestyle{fancy}}]{#2} % file name
		\addtocounter{pg}{1} 
	}
}
```

Package dependencies in preamble:

```latex
\usepackage{pdfpages}
\usepackage{ifthen}
\newcounter{pg}
```