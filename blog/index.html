---
layout: default
title: Blog Timeline
permalink: /blog/
categories:
- blog
category: blog
---
<div class="container my-5">

    {% comment %} --- HEADER SECTION (CONSISTENT ELEGANT STYLE) --- {% endcomment %}
    <h1 class="mb-4 text-center">Research Blog</h1>
    <p class="lead text-center text-muted mb-5">
        A journal of functional logs, insights, and small ideas related to chemistry education research, technology, and professional development.
    </p>

    {% comment %} --- DYNAMIC TAGS FILTER BLOCK (ALPHABETICAL DROPDOWN) --- {% endcomment %}
    {% assign all_tags_raw = site.categories.blog | map: "tags" | compact | uniq %}
    {% assign total_posts = site.categories.blog | size %}
    {% assign sortable_tags = '' | split: '' %}

    {% comment %} 1. PREPARE ARRAY FOR CASE-INSENSITIVE SORTING {% endcomment %}
    {% for tag in all_tags_raw %}
    {% assign tag_count = 0 %}
    {% for post in site.categories.blog %}
    {% if post.tags contains tag %}{% assign tag_count = tag_count | plus: 1 %}{% endif %}
    {% endfor %}

    {% comment %} Create a simple list of original tag names and counts. Liquid will not sort this. {% endcomment %}
    {% assign tag_item = '{ "name": "' | append: tag | append: '", "count": ' | append: tag_count | append: ' }' %}
    {% assign sortable_tags = sortable_tags | push: tag_item %}
    {% endfor %}

    {% comment %} 2. SORT ALPHABETICALLY USING THE DOWNCASED KEY {% endcomment %}
    {% assign sorted_tags = sortable_tags | sort: 'sort_key' %}

    <div class="mb-4 d-flex justify-content-end">

        <div class="tag-filter-container">
            <label for="tag-selector" class="form-label d-none d-lg-inline-block small text-muted me-2 mb-0">Filter by Topic:</label>
            <select id="tag-selector" class="form-select form-select-sm d-inline-block w-auto">
                <option value="all" selected>All Topics ({{ total_posts }})</option>

                {% comment %} 3. RENDER ALL TAGS ALPHABETICALLY {% endcomment %}
                {% for tag_item in sorted_tags %}
                {% comment %} Safely extract name and count from the structured string {% endcomment %}
                {% assign parts = tag_item | remove_first: '{ "name": "' | split: '", "count": ' %}
                {% assign tag = parts | first | remove_first: '}' | split: '", "count": ' | first %}
                {% assign count = parts | last | split: '", "count": ' | last | remove_first: '}' | remove_first: '"' | split: '"' | last | remove_first: '}' %}

                <option value="{{ tag | slugify }}">
                    {{ tag }} ({{ count }})
                </option>
                {% endfor %}
            </select>
        </div>
    </div>
    {% comment %} --- END DYNAMIC TAGS FILTER BLOCK --- {% endcomment %}


    <div class="row row-cols-1 row-cols-lg-2 g-4" id="blog-post-list">
        {% for post in site.categories.blog %}
        <div class="col blog-post-item" data-tags="{% for tag in post.tags %}{{ tag | slugify }} {% endfor %}">
            <div class="card shadow-sm h-100 border-0">
                <div class="card-body d-flex p-3">

                    {% comment %} --- DATE BLOCK (CONSISTENT STYLE) --- {% endcomment %}
                    <div class="flex-shrink-0 text-center me-3" style="width: 70px;">
                        <h2 class="display-6 fw-bold text-info mb-0 lh-1">{{ post.date | date: "%-d" }}</h2>
                        <small class="text-secondary fw-bold text-uppercase d-block mt-n1">{{ post.date | date: "%b %Y" }}</small>
                    </div>
                    {% comment %} --- END DATE BLOCK --- {% endcomment %}

                    <div class="flex-grow-1">
                        <h6 class="card-title fw-semibold mb-1">
                            <a href="{{ post.url | relative_url }}" class="text-decoration-none text-body">{{ post.title }}</a>
                        </h6>
                        <p class="card-text small text-muted">
                            {% if post.author %}
                            by
                            {% for member in site.categories.team %}
                            {% if member.name == post.author %}
                            <a href="{{ member.url | relative_url }}" class="text-decoration-none">{{ post.author }}</a>
                            {% endif %}
                            {% endfor %}
                            {% endif %}
                        </p>
                        <p class="card-text small mt-2">
                            {{ post.excerpt | strip_html | truncatewords: 30 }}
                        </p>
                    </div>
                </div>

                {% if post.tags %}
                <div class="card-footer bg-body-tertiary border-top-0 pt-0">
                    <div class="d-flex flex-wrap card-footer-inset" style="gap: 0.5rem;">
                        {% for tag in post.tags %}

                        <a href="#" class="badge text-bg-secondary text-decoration-none blog-tag-filter-trigger" data-tag-slug="{{ tag | slugify }}">#{{ tag }}</a>

                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>

</div>

{% comment %} --- JAVASCRIPT FOR CLIENT-SIDE FILTERING --- {% endcomment %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tagSelector = document.getElementById('tag-selector');
        const postItems = document.querySelectorAll('.blog-post-item');

        if (!tagSelector) return;

        // --- 1. JAVASCRIPT SORT FIX ---
        (function sortDropdown() {
            const options = Array.from(tagSelector.options);
            const selectedValue = tagSelector.value;
            const sortableOptions = options.slice(1);
            const collator = new Intl.Collator(undefined, { sensitivity: 'base' });
            sortableOptions.sort((a, b) => collator.compare(a.text, b.text));
            tagSelector.innerHTML = '';
            tagSelector.appendChild(options[0]);
            sortableOptions.forEach(option => tagSelector.appendChild(option));
            tagSelector.value = selectedValue;
        })();

        // 2. FILTERING FUNCTION
        function filterPosts(selectedTagSlug) {
            postItems.forEach(item => {
                const itemTags = item.getAttribute('data-tags');
                if (selectedTagSlug === 'all' || itemTags.includes(selectedTagSlug)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // 3. EVENT LISTENER (DROPDOWN)
        tagSelector.addEventListener('change', function() {
            filterPosts(this.value);
        });

        // 4. EVENT LISTENERS (TAG BADGES)
        const tagBadges = document.querySelectorAll('.blog-tag-filter-trigger');
        tagBadges.forEach(badge => {
            badge.addEventListener('click', function(event) {
                event.preventDefault();
                const tagSlug = this.getAttribute('data-tag-slug');
                tagSelector.value = tagSlug;
                filterPosts(tagSlug);
                tagSelector.scrollIntoView({ behavior: 'smooth', block: 'end' });
            });
        });

        // 5. INITIAL STATE SETUP (READ FROM URL HASH) --- MODIFIED SECTION ---
        (function setInitialFilter() {
            const slugFromUrl = window.location.hash.substring(1); // Get hash, remove '#'

            if (slugFromUrl) {
                // Check if an option with this hash value (slug) actually exists
                const optionExists = tagSelector.querySelector(`option[value="${slugFromUrl}"]`);

                if (optionExists) {
                    // If it exists, set the dropdown's value to it
                    tagSelector.value = slugFromUrl;
                }
            }

            // Now, run the filter based on the (potentially updated) selector value
            filterPosts(tagSelector.value);

            if (slugFromUrl && tagSelector.querySelector(`option[value="${slugFromUrl}"]`)) {
                 tagSelector.scrollIntoView({ behavior: 'smooth', block: 'end' });
            }
        })();

    });
</script>